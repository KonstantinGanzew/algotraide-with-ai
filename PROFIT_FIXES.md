# üîß –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –î–õ–Ø –†–ï–ê–õ–¨–ù–û–ô –ü–†–ò–ë–´–õ–¨–ù–û–°–¢–ò

## üö® –ü–†–û–ë–õ–ï–ú–ê
**–ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–ª—É—á–∞–ª –Ω–∞–≥—Ä–∞–¥—ã ~32000, –Ω–æ –±–∞–ª–∞–Ω—Å –æ—Å—Ç–∞–≤–∞–ª—Å—è 10000 USDT**
- 841 —Å–¥–µ–ª–∫–∞ –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏
- –°–∏—Å—Ç–µ–º–∞ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–π –Ω–µ –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–ª–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º –±–∞–ª–∞–Ω—Å–æ–º
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∏–±—ã–ª–∏ –∏ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. **–ò–°–ü–†–ê–í–õ–ï–ù–ê —Ñ—É–Ω–∫—Ü–∏—è `_calculate_profit()`**
**–°–¢–ê–†–ê–Ø (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è):**
```python
def _calculate_profit(self, current_price):
    order_size = self._calculate_dynamic_order_size()  # ‚ùå –ü–µ—Ä–µ—Å—á–µ—Ç –∫–∞–∂–¥—ã–π —Ä–∞–∑
    profit_per_coin = current_price - self.entry_price
    return (profit_per_coin * order_size * self.position_size) / self.entry_price  # ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞
```

**–ù–û–í–ê–Ø (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è):**
```python
def _calculate_profit(self, current_price):
    if self.position_size <= 0 or self.entry_price <= 0:
        return 0.0
    price_change_percent = (current_price / self.entry_price) - 1
    profit = self.position_size * price_change_percent  # ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞
    return profit
```

### 2. **–£–ü–†–û–©–ï–ù–ê —Ñ—É–Ω–∫—Ü–∏—è `_calculate_dynamic_order_size()`**
**–°–¢–ê–†–ê–Ø (—Å–ª–æ–∂–Ω–∞—è):**
```python
# –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏, –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏...
```

**–ù–û–í–ê–Ø (–ø—Ä–æ—Å—Ç–∞—è):**
```python
def _calculate_dynamic_order_size(self):
    available_balance = self.balance
    position_value = available_balance * Config.RISK_PER_TRADE  # 2% –æ—Ç –±–∞–ª–∞–Ω—Å–∞
    return position_value  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—É–º–º—É –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö
```

### 3. **–ü–ï–†–ï–†–ê–ë–û–¢–ê–ù–ê —Å–∏—Å—Ç–µ–º–∞ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–π**
**–°–¢–ê–†–ê–Ø (–º–Ω–æ–≥–æ–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞—è):**
```python
# –ë–æ–Ω—É—Å—ã –∑–∞ —Ç–æ—Ä–≥–æ–≤–ª—é, momentum, volatility, streak –∏ —Ç.–¥.
total_reward = base_reward + trade_motivation + momentum_bonus + volatility_bonus + ...
```

**–ù–û–í–ê–Ø (–ø—Ä–æ—Å—Ç–∞—è –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è):**
```python
def _calculate_simplified_reward(self, current_price, action):
    balance_change = current_total_balance - prev_total_balance
    base_reward = (balance_change / self.initial_balance) * 1000  # –¢–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
    total_reward = base_reward - drawdown_penalty  # –ü—Ä–æ—Å—Ç–∞—è –∏ –ø—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω–∞—è
    return total_reward
```

### 4. **–ò–°–ü–†–ê–í–õ–ï–ù–ê —Ç–æ—Ä–≥–æ–≤–∞—è –ª–æ–≥–∏–∫–∞**
**–°–¢–ê–†–ê–Ø (–±–∞–ª–∞–Ω—Å –Ω–µ –º–µ–Ω—è–ª—Å—è –ø—Ä–∏ —Ç–æ—Ä–≥–æ–≤–ª–µ):**
```python
elif action == 1:  # Buy
    self.position_size = self._calculate_dynamic_order_size()
    # ‚ùå –ë–∞–ª–∞–Ω—Å –Ω–µ —Å–ø–∏—Å—ã–≤–∞–ª—Å—è
```

**–ù–û–í–ê–Ø (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–∞–ª–∞–Ω—Å–∞):**
```python
elif action == 1:  # Buy
    position_value = self._calculate_dynamic_order_size()
    if position_value <= self.balance:
        self.position_size = position_value
        self.balance -= position_value  # ‚úÖ –°–ø–∏—Å—ã–≤–∞–µ–º —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å –±–∞–ª–∞–Ω—Å–∞
        
elif action == 2:  # Sell
    profit = self._calculate_profit(current_price)
    self.balance += self.position_size + profit  # ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—É–º–º—É + –ø—Ä–∏–±—ã–ª—å
```

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø

### ‚úÖ –¢–µ—Å—Ç —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∏–±—ã–ª–∏:
- **–ü–æ–∑–∏—Ü–∏—è $1000, —Ä–æ—Å—Ç +10%**: –ü—Ä–∏–±—ã–ª—å $100.00 ‚úÖ
- **–ü–æ–∑–∏—Ü–∏—è $1000, –ø–∞–¥–µ–Ω–∏–µ -10%**: –£–±—ã—Ç–æ–∫ -$100.00 ‚úÖ

### ‚úÖ –¢–µ—Å—Ç —Ç–æ—Ä–≥–æ–≤–æ–π –ª–æ–≥–∏–∫–∏:
- **–ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å**: $10,000
- **–ü–æ–∫—É–ø–∫–∞**: $200 (2% —Ä–∏—Å–∫–∞)
- **–†–æ—Å—Ç —Ü–µ–Ω—ã**: +5%
- **–§–∏–Ω–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å**: $10,010 (+$10 –ø—Ä–∏–±—ã–ª–∏) ‚úÖ

### ‚úÖ –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–π:
- **–°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞**: +5.0 (–∑–∞ –¥–µ–π—Å—Ç–≤–∏–µ) ‚ùå
- **–ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞**: +1.00 (–∑–∞ –ø—Ä–∏–±—ã–ª—å $10) ‚úÖ
- **–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å –ø—Ä–∏–±—ã–ª—å—é**: –î–ê ‚úÖ

---

## üöÄ –ö–ê–ö –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨

### –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```bash
python quick_test.py
```

### –ü–æ–ª–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏:
```bash
source venv/bin/activate
python main.py
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π:
```bash
python test_profit_fix.py  # –ü–æ–¥—Ä–æ–±–Ω—ã–µ —Ç–µ—Å—Ç—ã (–µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è)
```

---

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

–ü–æ—Å–ª–µ —ç—Ç–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–æ–ª–∂–µ–Ω:

1. **üéØ –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å** - –Ω–∞–≥—Ä–∞–¥—ã –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—Ç —Å —Ä–æ—Å—Ç–æ–º –±–∞–ª–∞–Ω—Å–∞
2. **üí∞ –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–∏–±—ã–ª—å** - –ø—Ä–æ—Å—Ç–∞—è –∏ —Ç–æ—á–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞
3. **üîÑ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç–æ—Ä–≥–æ–≤–ª—é** - —Å–ø–∏—Å–∞–Ω–∏–µ/–≤–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å
4. **üìà –û–±—É—á–∞—Ç—å—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏** - –≤—ã—Å–æ–∫–∏–µ –Ω–∞–≥—Ä–∞–¥—ã = –≤—ã—Å–æ–∫–∞—è –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å

---

## üîç –ö–õ–Æ–ß–ï–í–´–ï –ü–†–ò–ù–¶–ò–ü–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

1. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ > –°–ª–æ–∂–Ω–æ—Å—Ç—å** - —É–±—Ä–∞–Ω—ã –∏–∑–ª–∏—à–Ω–∏–µ –±–æ–Ω—É—Å—ã –∏ –º–Ω–æ–∂–∏—Ç–µ–ª–∏
2. **–†–µ–∞–ª—å–Ω–æ—Å—Ç—å > –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å** - –Ω–∞–≥—Ä–∞–¥—ã —Ç–æ–ª—å–∫–æ –∑–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
3. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å > –°–∫–æ—Ä–æ—Å—Ç—å** - –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –≤–∞–∂–Ω–µ–µ –±—ã—Å—Ç—Ä–æ—Ç—ã
4. **–ü—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å > –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** - –≤–∞–∂–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∞ –Ω–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫

---

## üéâ –°–¢–ê–¢–£–°: –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ

‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã  
‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ  
‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –æ–±—É—á–µ–Ω–∏—é —Ä–µ–∞–ª—å–Ω–æ–π –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏  
üöÄ **–ê–ª–≥–æ—Ä–∏—Ç–º —Ç–µ–ø–µ—Ä—å –¥–æ–ª–∂–µ–Ω –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –†–ï–ê–õ–¨–ù–£–Æ –ø—Ä–∏–±—ã–ª—å!** 